# Build & Update Luau Libraries (without LFS, optimized size)
name: Build & Update Luau Libraries

permissions:
  contents: write

on:
  schedule:
    - cron: '0 0 * * *'
  workflow_dispatch:
  push:
    branches: [ main, master ]
    paths:
      - '.github/workflows/main.yml'
    tags:
      - 'v*'

jobs:
  build-windows:
    runs-on: windows-latest
    steps:
      - name: Clone Luau repository
        run: |
          git clone https://github.com/Roblox/luau.git luau-build
          cd luau-build
          git log -1 --oneline

      - name: Patch Luau TypeChecker warning - Robust
        shell: bash
        run: |
          set -e
          cd luau-build
          
          # åˆ›å»ºä¸´æ—¶Pythonè„šæœ¬
          cat > temp_patch.py << 'EOF'
          import pathlib
          import sys

           try:
               path = pathlib.Path("Analysis/src/TypeChecker2.cpp")
                if path.exists():
                  text = path.read_text(encoding='utf-8')
                  marker = "lookupAnnotation(ref->parameters.data[0].type)"
                  replacement = "lookupAnnotation(ann)"
      

      - name: Setup MSVC
        uses: microsoft/setup-msbuild@v1.1

      - name: Build Luau (Windows x64) - Robust
        run: |
          cd luau-build
          
          # åˆ›å»ºæ„å»ºç›®å½•
          if (-not (Test-Path "build-release")) {
            New-Item -ItemType Directory -Force -Path "build-release"
          }
          
          cd build-release
          
          # é…ç½®CMake
          cmake .. \
            -DCMAKE_BUILD_TYPE=Release \
            -A x64 \
            -DBUILD_TESTING=OFF \
            -DLUAU_BUILD_TESTS=OFF \
            -DCMAKE_C_FLAGS="/O2 /Zi" \
            -DCMAKE_CXX_FLAGS="/O2 /Zi" \
            -G "NMake Makefiles"
          
          # æ„å»º
          nmake

      - name: Setup LLVM strip
        shell: pwsh
        run: |
          choco install llvm -y
          refreshenv
          
          # éªŒè¯å®‰è£…
          $llvmStrip = "${env:ProgramFiles}\LLVM\bin\llvm-strip.exe"
          if (Test-Path $llvmStrip) {
            Write-Host "âœ… LLVM installed successfully"
            echo "STRIP_CMD=$llvmStrip" | Out-File -FilePath $env:GITHUB_ENV -Encoding utf8 -Append
          } else {
            Write-Host "âš ï¸  LLVM strip not found"
          }

      - name: Collect Windows Libraries - Robust
        run: |
          # ç¡®ä¿ç›®å½•å­˜åœ¨
          New-Item -ItemType Directory -Force -Path "artifacts\windows-x64\lib"
          
          $buildDir = "luau-build\build-release"
          
          # å¤åˆ¶.libæ–‡ä»¶
          $libFiles = Get-ChildItem -Path $buildDir -Filter "*.lib" -ErrorAction SilentlyContinue
          if ($libFiles) {
            foreach ($file in $libFiles) {
              Copy-Item $file.FullName "artifacts\windows-x64\lib\" -Force
              Write-Host "âœ… Copied: $($file.Name)"
            }
          } else {
            Write-Host "âš ï¸  No .lib files found"
          }
          
          # å¤åˆ¶.dllæ–‡ä»¶
          $dllFiles = Get-ChildItem -Path $buildDir -Filter "*.dll" -ErrorAction SilentlyContinue
          if ($dllFiles) {
            foreach ($file in $dllFiles) {
              Copy-Item $file.FullName "artifacts\windows-x64\lib\" -Force
              Write-Host "âœ… Copied: $($file.Name)"
            }
          }
          
          # éªŒè¯ç»“æœ
          Write-Host "`nğŸ“Š Collected libraries:"
          Get-ChildItem "artifacts\windows-x64\lib" | ForEach-Object {
            $sizeKB = [math]::Round($_.Length/1KB, 2)
            Write-Host "  $($_.Name): $sizeKB KB"
          }

      - name: Strip Windows libraries - Robust
        shell: pwsh
        run: |
          $strip = $env:STRIP_CMD
          
          if ($strip -and (Test-Path $strip)) {
            Write-Host "ğŸ› ï¸  Stripping libraries..."
            
            # è®°å½•åŸå§‹å¤§å°
            Write-Host "`nBefore stripping:"
            Get-ChildItem "artifacts\windows-x64\lib" | ForEach-Object {
              $sizeKB = [math]::Round($_.Length/1KB, 2)
              Write-Host "  $($_.Name): $sizeKB KB"
            }
            
            # æ‰§è¡Œstrip
            Get-ChildItem "artifacts\windows-x64\lib" | ForEach-Object { 
              try {
                & $strip --strip-debug $_.FullName
                Write-Host "âœ… Stripped: $($_.Name)"
              } catch {
                Write-Host "âš ï¸  Failed to strip: $($_.Name)"
              }
            }
            
            # è®°å½•å¤„ç†åå¤§å°
            Write-Host "`nAfter stripping:"
            Get-ChildItem "artifacts\windows-x64\lib" | ForEach-Object {
              $sizeKB = [math]::Round($_.Length/1KB, 2)
              Write-Host "  $($_.Name): $sizeKB KB"
            }
            
            # è®¡ç®—æ€»å¤§å°
            $totalSize = (Get-ChildItem "artifacts\windows-x64\lib" | Measure-Object -Property Length -Sum).Sum / 1MB
            Write-Host "`nğŸ“Š Total size: $([math]::Round($totalSize, 2)) MB"
            
          } else {
            Write-Host "âš ï¸  llvm-strip not available, skipping strip"
          }

      - name: Upload Windows Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: windows-x64-libs
          path: artifacts/windows-x64/
  build-linux:
    runs-on: ubuntu-latest
    steps:
      - name: Clone Luau repository
        run: |
          git clone https://github.com/Roblox/luau.git luau-build
          cd luau-build
          git log -1 --oneline

      - name: Patch Luau TypeChecker warning
        shell: bash
        run: |
          cd luau-build
          python - <<'PY'
          from pathlib import Path

          path = Path("Analysis/src/TypeChecker2.cpp")
          marker = "lookupAnnotation(ref->parameters.data[0].type)"
          replacement = "lookupAnnotation(ann)"
          text = path.read_text()
          if marker in text:
              path.write_text(text.replace(marker, replacement, 1))
              print("patched TypeChecker2.cpp")
          else:
              print("marker not found; skipping patch (already applied?)")
          PY

      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential cmake

      - name: Build Luau (Linux x64) - Optimized Size
        run: |
          cd luau-build
          mkdir build-release
          cd build-release
          
          # ä½¿ç”¨é€‚ä¸­çš„ä¼˜åŒ–å‚æ•°ï¼Œé¿å…è¿‡åº¦å‹ç¼©
          cmake .. \
            -DCMAKE_BUILD_TYPE=Release \
            -DBUILD_TESTING=OFF \
            -DLUAU_BUILD_TESTS=OFF \
            -DCMAKE_C_FLAGS="-O2 -g -march=x86-64 -mtune=generic" \
            -DCMAKE_CXX_FLAGS="-O2 -g -march=x86-64 -mtune=generic" \
            -DCMAKE_EXE_LINKER_FLAGS="-Wl,--gc-sections" \
            -DCMAKE_SHARED_LINKER_FLAGS="-Wl,--gc-sections"
          
          cmake --build . --config Release -j$(nproc)

      - name: Check Library Sizes Before Strip (Linux)
        run: |
          echo "=== Linux Library Sizes Before Strip ==="
          find luau-build/build-release -name "*.a" -o -name "*.so" | while read file; do
            size=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file" 2>/dev/null)
            sizeMB=$(echo "scale=2; $size/1024/1024" | bc)
            basename "$file": $sizeMB MB
          done

      - name: Collect Linux Libraries
        run: |
          mkdir -p artifacts/linux-x64/lib
          find luau-build/build-release -name "*.a" -exec cp {} artifacts/linux-x64/lib/ \;
          find luau-build/build-release -name "*.so" -exec cp {} artifacts/linux-x64/lib/ \; 2>/dev/null || true

      - name: Minimal Strip Linux libraries
        run: |
          # åªç§»é™¤è°ƒè¯•èŠ‚ï¼Œä¿ç•™ç¬¦å·è¡¨å’Œå‡½æ•°ä¿¡æ¯
          strip --remove-section=.comment --remove-section=.note --preserve-dates artifacts/linux-x64/lib/*.a 2>/dev/null || true
          find artifacts/linux-x64/lib -name "*.so" -exec strip --remove-section=.comment --remove-section=.note --preserve-dates {} \; 2>/dev/null || true
          
      - name: Final Size Check (Linux)
        run: |
          echo "=== Final Linux Library Sizes ==="
          ls -lh artifacts/linux-x64/lib/ | awk '{print $5, $9}'
          echo "Total Linux Libraries:"
          du -sh artifacts/linux-x64/

      - name: Upload Linux Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: linux-x64-libs
          path: artifacts/linux-x64/

  build-macos:
    runs-on: macos-latest
    strategy:
      matrix:
        arch: [x86_64, arm64]
    steps:
      - name: Clone Luau repository
        run: |
          git clone https://github.com/Roblox/luau.git luau-build
          cd luau-build
          git log -1 --oneline

      - name: Patch Luau TypeChecker warning
        shell: bash
        run: |
          cd luau-build
          python - <<'PY'
          from pathlib import Path

          path = Path("Analysis/src/TypeChecker2.cpp")
          marker = "lookupAnnotation(ref->parameters.data[0].type)"
          replacement = "lookupAnnotation(ann)"
          text = path.read_text()
          if marker in text:
              path.write_text(text.replace(marker, replacement, 1))
              print("patched TypeChecker2.cpp")
          else:
              print("marker not found; skipping patch (already applied?)")
          PY

      - name: Install dependencies
        run: |
          brew install cmake

      - name: Build Luau (macOS ${{ matrix.arch }}) - Optimized Size
        run: |
          cd luau-build
          mkdir build-release-${{ matrix.arch }}
          cd build-release-${{ matrix.arch }}
          
          cmake .. \
            -DCMAKE_BUILD_TYPE=Release \
            -DCMAKE_OSX_ARCHITECTURES=${{ matrix.arch }} \
            -DBUILD_TESTING=OFF \
            -DLUAU_BUILD_TESTS=OFF \
            -DCMAKE_C_FLAGS="-O2 -g" \
            -DCMAKE_CXX_FLAGS="-O2 -g" \
            -DCMAKE_EXE_LINKER_FLAGS="" \
            -DCMAKE_SHARED_LINKER_FLAGS=""
          
          cmake --build . --config Release -j$(sysctl -n hw.ncpu)
          
      - name: Collect macOS Libraries
        run: |
          mkdir -p artifacts/macos-${{ matrix.arch }}/lib
          find luau-build/build-release-${{ matrix.arch }} -name "*.a" -exec cp {} artifacts/macos-${{ matrix.arch }}/lib/ \;
          find luau-build/build-release-${{ matrix.arch }} -name "*.dylib" -exec cp {} artifacts/macos-${{ matrix.arch }}/lib/ \; 2>/dev/null || true

      - name: Minimal Strip macOS libraries
        run: |
          # åªç§»é™¤è°ƒè¯•ä¿¡æ¯ï¼Œä¿ç•™ç¬¦å·è¡¨
          strip -x -S artifacts/macos-${{ matrix.arch }}/lib/*.a 2>/dev/null || true
          find artifacts/macos-${{ matrix.arch }}/lib -name "*.dylib" -exec strip -x -S {} \; 2>/dev/null || true

      - name: Final Size Check (macOS)
        run: |
          echo "=== Final macOS ${{ matrix.arch }} Library Sizes ==="
          ls -lh artifacts/macos-${{ matrix.arch }}/lib/ | awk '{print $5, $9}'
          
      - name: Upload macOS Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: macos-${{ matrix.arch }}-libs
          path: artifacts/macos-${{ matrix.arch }}/

  build-android:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        abi: [armv7, arm64-v8a, x86, x86_64]
    steps:
      - name: Clone Luau repository
        run: |
          git clone https://github.com/Roblox/luau.git luau-build
          cd luau-build
          git log -1 --oneline

      - name: Patch Luau TypeChecker warning
        shell: bash
        run: |
          cd luau-build
          python - <<'PY'
          from pathlib import Path

          path = Path("Analysis/src/TypeChecker2.cpp")
          marker = "lookupAnnotation(ref->parameters.data[0].type)"
          replacement = "lookupAnnotation(ann)"
          text = path.read_text()
          if marker in text:
              path.write_text(text.replace(marker, replacement, 1))
              print("patched TypeChecker2.cpp")
          else:
              print("marker not found; skipping patch (already applied?)")
          PY

      - name: Setup Android NDK
        uses: nttld/setup-ndk@v1
        with:
          ndk-version: r25c

      - name: Build Luau (Android ${{ matrix.abi }}) - Optimized Size
        run: |
          cd luau-build
          mkdir build-android-${{ matrix.abi }}
          cd build-android-${{ matrix.abi }}
          
          ANDROID_ABI=${{ matrix.abi }}
          if [ "${{ matrix.abi }}" = "armv7" ]; then ANDROID_ABI="armeabi-v7a"; fi
          
          cmake .. \
            -DCMAKE_TOOLCHAIN_FILE=$ANDROID_NDK_HOME/build/cmake/android.toolchain.cmake \
            -DANDROID_ABI=${ANDROID_ABI} \
            -DANDROID_PLATFORM=android-21 \
            -DCMAKE_BUILD_TYPE=Release \
            -DCMAKE_C_FLAGS="-O2 -g" \
            -DCMAKE_CXX_FLAGS="-O2 -g" \
            -DCMAKE_EXE_LINKER_FLAGS="-Wl,--gc-sections" \
            -DCMAKE_SHARED_LINKER_FLAGS="-Wl,--gc-sections" \
            -DBUILD_TESTING=OFF -DLUAU_BUILD_TESTS=OFF
            
          cmake --build . --config Release -j$(nproc)
          
      - name: Collect Android Libraries
        run: |
          mkdir -p artifacts/android-${{ matrix.abi }}/lib
          find luau-build/build-android-${{ matrix.abi }} -name "*.a" -exec cp {} artifacts/android-${{ matrix.abi }}/lib/ \;
          find luau-build/build-android-${{ matrix.abi }} -name "*.so" -exec cp {} artifacts/android-${{ matrix.abi }}/lib/ \; 2>/dev/null || true

      - name: Minimal Strip Android libraries
        run: |
          case "${{ matrix.abi }}" in
            armv7) TRIPLE=armv7a-linux-androideabi;;
            arm64-v8a) TRIPLE=aarch64-linux-android;;
            x86) TRIPLE=i686-linux-android;;
            x86_64) TRIPLE=x86_64-linux-android;;
          esac
          
          STRIP_CMD=${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64/bin/${TRIPLE}-strip
          
          # åªç§»é™¤è°ƒè¯•èŠ‚ï¼Œä¿ç•™ç¬¦å·è¡¨
          ${STRIP_CMD} --remove-section=.comment --remove-section=.note artifacts/android-${{ matrix.abi }}/lib/*.a 2>/dev/null || true
          find artifacts/android-${{ matrix.abi }}/lib -name "*.so" -exec ${STRIP_CMD} --remove-section=.comment --remove-section=.note {} \; 2>/dev/null || true
          
      - name: Upload Android Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: android-${{ matrix.abi }}-libs
          path: artifacts/android-${{ matrix.abi }}/

  build-ios:
    runs-on: macos-latest
    strategy:
      matrix:
        sdk: [iphoneos, iphonesimulator]
    steps:
      - name: Clone Luau repository
        run: |
          git clone https://github.com/Roblox/luau.git luau-build
          cd luau-build
          git log -1 --oneline

      - name: Patch Luau TypeChecker warning
        shell: bash
        run: |
          cd luau-build
          python - <<'PY'
          from pathlib import Path

          path = Path("Analysis/src/TypeChecker2.cpp")
          marker = "lookupAnnotation(ref->parameters.data[0].type)"
          replacement = "lookupAnnotation(ann)"
          text = path.read_text()
          if marker in text:
              path.write_text(text.replace(marker, replacement, 1))
              print("patched TypeChecker2.cpp")
          else:
              print("marker not found; skipping patch (already applied?)")
          PY

      - name: Build Luau (iOS ${{ matrix.sdk }}) - Optimized Size
        run: |
          cd luau-build
          mkdir build-ios-${{ matrix.sdk }}
          cd build-ios-${{ matrix.sdk }}
          
          if [ "${{ matrix.sdk }}" = "iphoneos" ]; then
            ARCH="arm64"
          else
            ARCH="x86_64"
          fi
          
          cmake .. \
            -DCMAKE_SYSTEM_NAME=iOS \
            -DCMAKE_OSX_SYSROOT=${{ matrix.sdk }} \
            -DCMAKE_OSX_ARCHITECTURES=$ARCH \
            -DCMAKE_BUILD_TYPE=Release \
            -DCMAKE_C_FLAGS="-O2 -g" \
            -DCMAKE_CXX_FLAGS="-O2 -g" \
            -DBUILD_TESTING=OFF -DLUAU_BUILD_TESTS=OFF
            
          cmake --build . --config Release -j$(sysctl -n hw.ncpu)
          
      - name: Collect iOS Libraries
        run: |
          mkdir -p artifacts/ios-${{ matrix.sdk }}/lib
          cp luau-build/build-ios-${{ matrix.sdk }}/Release/*.a artifacts/ios-${{ matrix.sdk }}/lib/ 2>/dev/null || true

      - name: Minimal Strip iOS libraries
        run: |
          # åªç§»é™¤è°ƒè¯•ä¿¡æ¯
          xcrun strip -S -x artifacts/ios-${{ matrix.sdk }}/lib/*.a 2>/dev/null || true
          
      - name: Upload iOS Artifacts
        uses: actions/upload-artifact@v4
        with:
          name: ios-${{ matrix.sdk }}-libs
          path: artifacts/ios-${{ matrix.sdk }}/

  create-release:
    needs: [build-windows, build-linux, build-macos, build-android, build-ios]
    runs-on: ubuntu-latest
    steps:
      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          path: all-artifacts

      - name: Create release package
        run: |
          mkdir -p release-package/lib
          
          # åˆ›å»ºç›®å½•ç»“æ„
          for platform in windows-x64 linux-x64 macos-x64 macos-arm64; do
            mkdir -p release-package/lib/${platform}
          done
          
          mkdir -p release-package/lib/android/armv7
          mkdir -p release-package/lib/android/arm64-v8a
          mkdir -p release-package/lib/android/x86
          mkdir -p release-package/lib/android/x86_64
          mkdir -p release-package/lib/ios
          
          # å¤åˆ¶æ–‡ä»¶
          cp -r all-artifacts/windows-x64-libs/* release-package/lib/windows-x64/ 2>/dev/null || true
          cp -r all-artifacts/linux-x64-libs/* release-package/lib/linux-x64/ 2>/dev/null || true
          cp -r all-artifacts/macos-x86_64-libs/* release-package/lib/macos-x64/ 2>/dev/null || true
          cp -r all-artifacts/macos-arm64-libs/* release-package/lib/macos-arm64/ 2>/dev/null || true
          cp -r all-artifacts/android-armv7-libs/* release-package/lib/android/armv7/ 2>/dev/null || true
          cp -r all-artifacts/android-arm64-v8a-libs/* release-package/lib/android/arm64-v8a/ 2>/dev/null || true
          cp -r all-artifacts/android-x86-libs/* release-package/lib/android/x86/ 2>/dev/null || true
          cp -r all-artifacts/android-x86_64-libs/* release-package/lib/android/x86_64/ 2>/dev/null || true
          cp -r all-artifacts/ios-*/* release-package/lib/ios/ 2>/dev/null || true
          
          # åˆ›å»ºå‹ç¼©åŒ…
          cd release-package/lib
          for build in windows-x64 linux-x64 macos-x64 macos-arm64 android ios; do
            if [ -d "${build}" ]; then
              zip -r ../linc_luau-${build}-libs-${GITHUB_REF_NAME}.zip ${build}
            fi
          done
          cd ../
          
          # åˆ›å»ºæœ€ç»ˆåŒ…
          tar -czf ../linc_luau-libs-${GITHUB_REF_NAME}.tar.gz lib
          zip -r linc_luau-libs-${GITHUB_REF_NAME}.zip lib linc_luau-*libs-${GITHUB_REF_NAME}.zip
          
      - name: Create GitHub Release (only on tags v*)
        if: startsWith(github.ref, 'refs/tags/v')
        uses: softprops/action-gh-release@v1
        with:
          files: |
            linc_luau-libs-*.tar.gz
            linc_luau-libs-*.zip
            linc_luau-windows-x64-libs-*.zip
            linc_luau-linux-x64-libs-*.zip
            linc_luau-macos-x64-libs-*.zip
            linc_luau-macos-arm64-libs-*.zip
            linc_luau-android-libs-*.zip
            linc_luau-ios-libs-*.zip
          draft: false
          prerelease: false
          generate_release_notes: true
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload libraries to repository (no LFS)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          set -e

          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

          git fetch origin main
          git checkout main
          git pull origin main

          # æ¸…ç†æ—§æ–‡ä»¶
          rm -rf lib/luau/lib || true
          
          # åˆ›å»ºç›®å½•ç»“æ„
          mkdir -p lib/luau/lib/windows-x64
          mkdir -p lib/luau/lib/linux-x64
          mkdir -p lib/luau/lib/macos-x64
          mkdir -p lib/luau/lib/macos-arm64
          mkdir -p lib/luau/lib/android/armv7
          mkdir -p lib/luau/lib/android/arm64-v8a
          mkdir -p lib/luau/lib/android/x86
          mkdir -p lib/luau/lib/android/x86_64
          mkdir -p lib/luau/lib/ios

          # å¤åˆ¶æ–°åº“æ–‡ä»¶ï¼ˆä¸ä½¿ç”¨LFSï¼‰
          cp -r all-artifacts/windows-x64-libs/* lib/luau/lib/windows-x64/ 2>/dev/null || true
          cp -r all-artifacts/linux-x64-libs/* lib/luau/lib/linux-x64/ 2>/dev/null || true
          cp -r all-artifacts/macos-x86_64-libs/* lib/luau/lib/macos-x64/ 2>/dev/null || true
          cp -r all-artifacts/macos-arm64-libs/* lib/luau/lib/macos-arm64/ 2>/dev/null || true
          cp -r all-artifacts/android-armv7-libs/* lib/luau/lib/android/armv7/ 2>/dev/null || true
          cp -r all-artifacts/android-arm64-v8a-libs/* lib/luau/lib/android/arm64-v8a/ 2>/dev/null || true
          cp -r all-artifacts/android-x86-libs/* lib/luau/lib/android/x86/ 2>/dev/null || true
          cp -r all-artifacts/android-x86_64-libs/* lib/luau/lib/android/x86_64/ 2>/dev/null || true
          cp -r all-artifacts/ios-*/* lib/luau/lib/ios/ 2>/dev/null || true

          # è®¾ç½®è¿œç¨‹URL
          git remote set-url origin "https://x-access-token:${GITHUB_TOKEN}@github.com/${{ github.repository }}"

          # æ·»åŠ åº“æ–‡ä»¶ï¼ˆæ™®é€šGitï¼Œä¸ä½¿ç”¨LFSï¼‰
          git add lib/luau/lib
          
          # æ£€æŸ¥æ˜¯å¦æœ‰å˜åŒ–
          if git diff --cached --quiet; then
            echo "æ²¡æœ‰å˜åŒ–éœ€è¦æäº¤"
            exit 0
          fi

          # æäº¤æ›´æ”¹
          GIT_AUTHOR_NAME="${{ github.actor }}" \
          GIT_AUTHOR_EMAIL="${{ github.actor }}@users.noreply.github.com" \
          git commit -m "ğŸ¤– Update prebuilt Luau libraries for ${{ github.ref_name }}

          - Built with moderate optimization (-O2)
          - Libraries without Git LFS (direct Git storage)
          - Platforms: Windows, Linux, macOS, Android, iOS
          - Optimized size (target ~15MB total)"

          # æ¨é€åˆ°ä»“åº“
          git push origin main
